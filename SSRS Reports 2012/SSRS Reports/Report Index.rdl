<?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <DataSources>
    <DataSource Name="Reports">
      <rd:DataSourceID>299f5ea7-4b7e-4ddf-9d72-30463df2c18f</rd:DataSourceID>
      <DataSourceReference>Reports</DataSourceReference>
    </DataSource>
  </DataSources>
  <InteractiveHeight>11in</InteractiveHeight>
  <Description>This is a report of the Reporting Services Catalog.</Description>
  <ReportParameters>
    <ReportParameter Name="ReportNumber">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>ABC000123.456</Value>
        </Values>
      </DefaultValue>
      <AllowBlank>true</AllowBlank>
    </ReportParameter>
    <ReportParameter Name="ReportPath">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>=Globals!ReportFolder + "/" + Globals!ReportName</Value>
        </Values>
      </DefaultValue>
    </ReportParameter>
    <ReportParameter Name="ShowHidden">
      <DataType>Boolean</DataType>
      <DefaultValue>
        <Values>
          <Value>False</Value>
        </Values>
      </DefaultValue>
      <Prompt>Show Hidden</Prompt>
    </ReportParameter>
  </ReportParameters>
  <rd:DrawGrid>true</rd:DrawGrid>
  <InteractiveWidth>8.5in</InteractiveWidth>
  <rd:SnapToGrid>true</rd:SnapToGrid>
  <RightMargin>0.5in</RightMargin>
  <LeftMargin>0.5in</LeftMargin>
  <PageHeader>
    <PrintOnFirstPage>true</PrintOnFirstPage>
    <ReportItems>
      <Textbox Name="textbox6">
        <ToolTip>Report Title</ToolTip>
        <Top>0.2in</Top>
        <Style>
          <Color>LightSteelBlue</Color>
          <BorderColor>
            <Default>LightSteelBlue</Default>
          </BorderColor>
          <BorderStyle>
            <Top>Solid</Top>
            <Bottom>Solid</Bottom>
          </BorderStyle>
          <BorderWidth>
            <Default>2pt</Default>
            <Top>4pt</Top>
          </BorderWidth>
          <FontSize>24pt</FontSize>
          <FontWeight>700</FontWeight>
          <VerticalAlign>Middle</VerticalAlign>
          <PaddingLeft>2pt</PaddingLeft>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>2pt</PaddingTop>
          <PaddingBottom>2pt</PaddingBottom>
        </Style>
        <ZIndex>1</ZIndex>
        <CanGrow>true</CanGrow>
        <Value>=Globals!ReportName</Value>
      </Textbox>
      <Textbox Name="textbox14">
        <ToolTip>Report Execution and Number</ToolTip>
        <Style>
          <FontSize>8pt</FontSize>
          <TextAlign>Right</TextAlign>
          <PaddingLeft>2pt</PaddingLeft>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>2pt</PaddingTop>
          <PaddingBottom>2pt</PaddingBottom>
        </Style>
        <CanGrow>true</CanGrow>
        <Height>0.2in</Height>
        <Value>=Globals!ExecutionTime.ToString + "                                             " + Parameters!ReportNumber.Value</Value>
      </Textbox>
    </ReportItems>
    <Height>0.75in</Height>
    <PrintOnLastPage>true</PrintOnLastPage>
  </PageHeader>
  <BottomMargin>0.5in</BottomMargin>
  <rd:ReportID>bc2c8e85-4671-4f1a-ab63-bec0fe141da8</rd:ReportID>
  <DataSets>
    <DataSet Name="Parameters">
      <Fields>
        <Field Name="Order">
          <DataField>Order</DataField>
          <rd:TypeName>System.Int64</rd:TypeName>
        </Field>
        <Field Name="ParameterName">
          <DataField>ParameterName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ParameterLabel">
          <DataField>ParameterLabel</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="DefaultValue">
          <DataField>DefaultValue</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ParameterXml">
          <DataField>ParameterXml</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ReportName">
          <DataField>ReportName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ReportPath">
          <DataField>ReportPath</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>Reports</DataSourceName>
        <CommandText>SELECT
	[Order] = ROW_NUMBER() OVER (ORDER BY tmp.Name),
	ParameterName = Params.p.value('Name[1]','varchar(255)'),
	ParameterLabel = Params.p.value('Prompt[1]','varchar(255)'),
	DefaultValue = Params.p.query('DefaultValues/Value'),
	ParameterXml = Params.p.query('.'),
	ReportName = tmp.Name,
	ReportPath = tmp.Path
FROM 
	(SELECT Name, Path, ReportParams = CONVERT(XML,Parameter) FROM dbo.Catalog WHERE Path = @ReportPath) tmp
	CROSS APPLY ReportParams.nodes('(Parameters/Parameter)') AS Params(p)
WHERE NOT Params.p.value('Name[1]','varchar(255)') IN ('ReportPath','ReportNumber')</CommandText>
        <QueryParameters>
          <QueryParameter Name="@ReportPath">
            <Value>=Parameters!ReportPath.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
    <DataSet Name="ds">
      <Fields>
        <Field Name="ItemID">
          <DataField>ItemID</DataField>
          <rd:TypeName>System.Guid</rd:TypeName>
        </Field>
        <Field Name="Path">
          <DataField>Path</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Name">
          <DataField>Name</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ParentID">
          <DataField>ParentID</DataField>
          <rd:TypeName>System.Guid</rd:TypeName>
        </Field>
        <Field Name="Type">
          <DataField>Type</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="Description">
          <DataField>Description</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Hidden">
          <DataField>Hidden</DataField>
          <rd:TypeName>System.Boolean</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>Reports</DataSourceName>
        <CommandText>SELECT
	pri.ItemID,
	pri.Path,
	pri.Name,
	pri.ParentID,
	pri.Type,
	pri.Description,
	Hidden
FROM 
	Catalog pri
WHERE
	(
		@ShowHidden = 1
		OR (
			Hidden = 0
			AND COALESCE((SELECT flt.Hidden FROM Catalog flt WHERE flt.ItemID = pri.ParentID),0) = 0
		)
	)
	AND NOT pri.ParentID IS NULL</CommandText>
        <QueryParameters>
          <QueryParameter Name="@ShowHidden">
            <Value>=Parameters!ShowHidden.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
  </DataSets>
  <Author>Ryan Duclos</Author>
  <Code>Shared Function SetColumn(ByVal row As Integer, ByVal column As Integer) As String
  While row &gt; column
    If column &gt;= row Then Exit While
    row = row - column
  End While

  Return row
End Function

Shared Function SetRow(ByVal row As Integer, ByVal column As Integer) As String
  Dim i As Integer = 1

  While row &gt; column
    i = i + 1
    If column &gt;= row Then Exit While
    row = row - column
  End While

  Return i
End Function</Code>
  <Width>7.5in</Width>
  <Body>
    <ReportItems>
      <Rectangle Name="rectangle2">
        <ZIndex>1</ZIndex>
        <ToolTip>Report Parameter List</ToolTip>
        <ReportItems>
          <Matrix Name="matrix1">
            <MatrixColumns>
              <MatrixColumn>
                <Width>3.74in</Width>
              </MatrixColumn>
            </MatrixColumns>
            <ZIndex>2</ZIndex>
            <DataSetName>Parameters</DataSetName>
            <RowGroupings>
              <RowGrouping>
                <Width>0.03125in</Width>
                <DynamicRows>
                  <Grouping Name="matrix1_RowGroup1">
                    <GroupExpressions>
                      <GroupExpression>=Code.SetRow(Fields!Order.Value,2)</GroupExpression>
                    </GroupExpressions>
                  </Grouping>
                  <ReportItems>
                    <Textbox Name="textbox1">
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <ZIndex>1</ZIndex>
                      <CanGrow>true</CanGrow>
                      <Value />
                    </Textbox>
                  </ReportItems>
                </DynamicRows>
              </RowGrouping>
            </RowGroupings>
            <Top>0.23in</Top>
            <ColumnGroupings>
              <ColumnGrouping>
                <Height>0.03125in</Height>
                <DynamicColumns>
                  <Grouping Name="matrix1_ColumnGroup1">
                    <GroupExpressions>
                      <GroupExpression>=Code.SetColumn(Fields!Order.Value,2)</GroupExpression>
                    </GroupExpressions>
                  </Grouping>
                  <ReportItems>
                    <Textbox Name="textbox4">
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <ZIndex>2</ZIndex>
                      <CanGrow>true</CanGrow>
                      <Value />
                    </Textbox>
                  </ReportItems>
                </DynamicColumns>
              </ColumnGrouping>
            </ColumnGroupings>
            <Width>3.77125in</Width>
            <Corner>
              <ReportItems>
                <Textbox Name="textbox8">
                  <Style>
                    <PaddingLeft>2pt</PaddingLeft>
                    <PaddingRight>2pt</PaddingRight>
                    <PaddingTop>2pt</PaddingTop>
                    <PaddingBottom>2pt</PaddingBottom>
                  </Style>
                  <ZIndex>3</ZIndex>
                  <CanGrow>true</CanGrow>
                  <Value />
                </Textbox>
              </ReportItems>
            </Corner>
            <MatrixRows>
              <MatrixRow>
                <Height>0.19792in</Height>
                <MatrixCells>
                  <MatrixCell>
                    <ReportItems>
                      <Rectangle Name="rectangle3">
                        <ReportItems>
                          <Textbox Name="textbox9">
                            <ToolTip>Parameter Name</ToolTip>
                            <CanShrink>true</CanShrink>
                            <Width>1.87in</Width>
                            <Style>
                              <FontSize>8pt</FontSize>
                              <FontWeight>700</FontWeight>
                              <TextAlign>Left</TextAlign>
                              <PaddingLeft>2pt</PaddingLeft>
                              <PaddingRight>2pt</PaddingRight>
                              <PaddingTop>2pt</PaddingTop>
                              <PaddingBottom>2pt</PaddingBottom>
                            </Style>
                            <ZIndex>1</ZIndex>
                            <CanGrow>true</CanGrow>
                            <Value>=IIf(Fields!ParameterLabel.Value = "", Fields!ParameterName.Value, Fields!ParameterLabel.Value)</Value>
                          </Textbox>
                          <Textbox Name="textbox5">
                            <ToolTip>Value used by the parameter</ToolTip>
                            <CanShrink>true</CanShrink>
                            <Style>
                              <Color>=IIf(Replace(Replace(Replace(Fields!DefaultValue.Value,"&lt;/Value&gt;&lt;Value&gt;",","),"&lt;Value&gt;",""),"&lt;/Value&gt;","") = IIf(Parameters(Fields!ParameterName.Value).IsMultiValue, Join(Parameters(Fields!ParameterName.Value).Label,","), Parameters(Fields!ParameterName.Value).Value), "Black", "Red")</Color>
                              <FontSize>8pt</FontSize>
                              <TextAlign>Left</TextAlign>
                              <PaddingLeft>2pt</PaddingLeft>
                              <PaddingRight>2pt</PaddingRight>
                              <PaddingTop>2pt</PaddingTop>
                              <PaddingBottom>2pt</PaddingBottom>
                            </Style>
                            <CanGrow>true</CanGrow>
                            <Left>1.87in</Left>
                            <Value>=IIf(Parameters(Fields!ParameterName.Value).IsMultiValue,
	Join(Parameters(Fields!ParameterName.Value).Label, ","),
	Parameters(Fields!ParameterName.Value).Value
)</Value>
                          </Textbox>
                        </ReportItems>
                      </Rectangle>
                    </ReportItems>
                  </MatrixCell>
                </MatrixCells>
              </MatrixRow>
            </MatrixRows>
          </Matrix>
          <Line Name="line2">
            <Top>0.45917in</Top>
            <Style>
              <BorderColor>
                <Default>LightSteelBlue</Default>
              </BorderColor>
              <BorderStyle>
                <Default>Solid</Default>
              </BorderStyle>
            </Style>
            <ZIndex>1</ZIndex>
          </Line>
          <Textbox Name="textbox15">
            <Style>
              <Color>White</Color>
              <BackgroundColor>LightSteelBlue</BackgroundColor>
              <BorderColor>
                <Default>LightSteelBlue</Default>
              </BorderColor>
              <BorderStyle>
                <Bottom>Solid</Bottom>
              </BorderStyle>
              <FontWeight>700</FontWeight>
              <TextAlign>Left</TextAlign>
              <PaddingLeft>2pt</PaddingLeft>
              <PaddingRight>2pt</PaddingRight>
              <PaddingTop>2pt</PaddingTop>
              <PaddingBottom>2pt</PaddingBottom>
            </Style>
            <CanGrow>true</CanGrow>
            <Height>0.23in</Height>
            <Value>Report Parameters</Value>
          </Textbox>
        </ReportItems>
        <PageBreakAtEnd>true</PageBreakAtEnd>
        <Height>0.45917in</Height>
      </Rectangle>
      <Table Name="table1">
        <DataSetName>ds</DataSetName>
        <Top>0.625in</Top>
        <Details>
          <TableRows>
            <TableRow>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Name">
                      <rd:DefaultName>Name</rd:DefaultName>
                      <Action>
                        <Hyperlink>="http://10.1.93.56/ReportServer?" + Fields!Path.Value</Hyperlink>
                      </Action>
                      <Style>
                        <Color>Blue</Color>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <TextDecoration>Underline</TextDecoration>
                        <PaddingLeft>=IIf(Level("table1_Details_Group") &gt; 0, CStr(Level("table1_Details_Group") * 10), "2") + "pt"</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <ZIndex>1</ZIndex>
                      <CanGrow>true</CanGrow>
                      <Value>=IIf(Fields!Hidden.Value, "*" + Fields!Name.Value, Fields!Name.Value)</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Description">
                      <rd:DefaultName>Description</rd:DefaultName>
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Value>=Fields!Description.Value</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
              <Height>0.25in</Height>
            </TableRow>
          </TableRows>
          <Grouping Name="table1_Details_Group">
            <Label>=Fields!Name.Value</Label>
            <GroupExpressions>
              <GroupExpression>=Fields!ItemID.Value</GroupExpression>
            </GroupExpressions>
            <Parent>=Fields!ParentID.Value</Parent>
          </Grouping>
          <Sorting>
            <SortBy>
              <SortExpression>=Fields!Path.Value</SortExpression>
              <Direction>Ascending</Direction>
            </SortBy>
          </Sorting>
        </Details>
        <Header>
          <TableRows>
            <TableRow>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox12">
                      <ToolTip>Name of the catalog item (* will display if the catalog item is hidden)</ToolTip>
                      <Style>
                        <Color>White</Color>
                        <BackgroundColor>LightSteelBlue</BackgroundColor>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>700</FontWeight>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <ZIndex>3</ZIndex>
                      <CanGrow>true</CanGrow>
                      <Value>="Name" + IIf(Parameters!ShowHidden.Value, " (* Hidden Items)", "")</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox13">
                      <Style>
                        <Color>White</Color>
                        <BackgroundColor>LightSteelBlue</BackgroundColor>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>700</FontWeight>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <ZIndex>2</ZIndex>
                      <CanGrow>true</CanGrow>
                      <Value>Description</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
              <Height>0.25in</Height>
            </TableRow>
          </TableRows>
          <RepeatOnNewPage>true</RepeatOnNewPage>
          <FixedHeader>true</FixedHeader>
        </Header>
        <TableColumns>
          <TableColumn>
            <Width>3.75in</Width>
          </TableColumn>
          <TableColumn>
            <Width>3.75in</Width>
          </TableColumn>
        </TableColumns>
      </Table>
    </ReportItems>
    <Height>1.125in</Height>
  </Body>
  <Language>en-US</Language>
  <PageFooter>
    <PrintOnFirstPage>true</PrintOnFirstPage>
    <ReportItems>
      <Textbox Name="textbox3">
        <rd:DefaultName>textbox3</rd:DefaultName>
        <ToolTip>Informational Statement</ToolTip>
        <Width>6in</Width>
        <Style>
          <BorderColor>
            <Default>LightSteelBlue</Default>
          </BorderColor>
          <BorderStyle>
            <Left>None</Left>
            <Right>None</Right>
            <Top>Solid</Top>
            <Bottom>None</Bottom>
          </BorderStyle>
          <BorderWidth>
            <Default>4pt</Default>
          </BorderWidth>
          <FontSize>8pt</FontSize>
          <VerticalAlign>Bottom</VerticalAlign>
          <PaddingLeft>2pt</PaddingLeft>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>2pt</PaddingTop>
          <PaddingBottom>2pt</PaddingBottom>
        </Style>
        <ZIndex>1</ZIndex>
        <CanGrow>true</CanGrow>
        <Value>="Globals!ReportFolder: " + Globals!ReportFolder + "." + vbcrlf +
"Globals!ReportName: " + Globals!ReportName + "." + vbcrlf +
"Globals!ReportServerURL: " + Globals!ReportServerUrl + "."</Value>
      </Textbox>
      <Textbox Name="textbox2">
        <ToolTip>Page information</ToolTip>
        <Style>
          <BorderColor>
            <Default>LightSteelBlue</Default>
          </BorderColor>
          <BorderStyle>
            <Left>None</Left>
            <Right>None</Right>
            <Top>Solid</Top>
            <Bottom>None</Bottom>
          </BorderStyle>
          <BorderWidth>
            <Default>4pt</Default>
          </BorderWidth>
          <FontSize>8pt</FontSize>
          <TextAlign>Right</TextAlign>
          <VerticalAlign>Bottom</VerticalAlign>
          <PaddingLeft>2pt</PaddingLeft>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>2pt</PaddingTop>
          <PaddingBottom>2pt</PaddingBottom>
        </Style>
        <CanGrow>true</CanGrow>
        <Left>6in</Left>
        <Value>= "Page " &amp; Globals!PageNumber &amp; " of " &amp; Globals!TotalPages</Value>
      </Textbox>
    </ReportItems>
    <Height>0.5in</Height>
    <PrintOnLastPage>true</PrintOnLastPage>
  </PageFooter>
  <TopMargin>0.5in</TopMargin>
</Report>